# CVE 2020-0601 AKA "Curveball"
A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates.An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source, aka 'Windows CryptoAPI Spoofing Vulnerability'.

## Reference
https://nvd.nist.gov/vuln/detail/CVE-2020-0601

## KQL
Data Source: [Winlogbeat](https://www.elastic.co/beats/winlogbeat)  
Query: `winlog.provider_name:"Microsoft-Windows-Audit-CVE"`

Data Source: [Zeek CVE-2020-0601 Plugin](https://github.com/0xxon/cve-2020-0601-plugin)  
Query: `zeek.notice.note:"CVE_2020-0601::Unknown_X509_Curve"`

## Modeling
Modeling is an important part of analysis, however it is not 1:1 "answer" to your analytical "question". 

### MITRE ATT&CK
MITRE ATT&CK is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&CK knowledge base is used as a foundation for the development of specific threat models and methodologies in the private sector, in government, and in the cybersecurity product and service community.

#### Reference
https://attack.mitre.org/

```
Name: Code Signing
ID: T1116
Tactic: Defense Evasion
Platform: macOS, Windows
Data Sources: Binary file metadata
Defense Bypassed: Windows User Account Control
```
https://attack.mitre.org/techniques/T1116/

### Diamond Model
This is a model that lays out 4 (or in the extended model, 6) elements of an intrusion phase. Adversary, Infrastructure, Victim, and Capability. As you collect information from each "point", you can begin to make assumptions as to what the other points _could_ be. The more you have on each point, the more accurate your assumptions can be. 

This model should be used in conjunction with other intrusion models, like the Lockheed Martin Cyber Kill Chain.

Do not use this model as an equation. Just because infrastructure is used in 2 intrusions, doesn't mean the victim or adversary are the same.

#### Reference
https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf

```
                      CVE-2020-0601
                      ┌───────────┐                 
                      │ Adversary │                 
                      └───────────┘                 
                            Λ                       
┌──────────────────────┐   ╱│╲                      
│      Capability      │  ╱ │ ╲                     
│    CVE 2020-0601     │ ╱  │  ╲  ┌────────────────┐
│ Code Signing (T1116) │▕───┼───▏ │ Infrastructure │
│   Defense Evasion    │ ╲  │  ╱  └────────────────┘
└──────────────────────┘  ╲ │ ╱                     
                           ╲│╱                      
                            V                       
                       ┌──────────┐                 
                       │  Victim  │                 
                       └──────────┘                 
```

### Lockheed Martin Cyber Kill Chain
Developed by Lockheed Martin, the Cyber Kill Chain® framework is part of the Intelligence Driven Defense® model for identification and prevention of cyber intrusions activity. The model identifies what the adversaries must complete in order to achieve their objective.

The seven steps of the Cyber Kill Chain® enhance visibility into an attack and enrich an analyst’s understanding of an adversary’s tactics, techniques and procedures.

1. Reconnaissance
1. Weaponization
1. Delivery
1. Exploitation
1. Installation
1. Command & Control
1. Actions on the Objective

```
Exploitation - CVE-2020-0601
```

#### Reference
https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html

## Analysis Notes
"Curveball" is an exploit that attempts to make a malicious executable or website certificate appear like it was signed by a trusted and legitiate source. In the event this is observed, analysts should begin looking back through the Application log to identify recently executed binaries or network logs to identify recently viewed websites on the affected host(s) and validate their signatures and behavior. 

### Collection 
While the signatures can be made to look like they're from valid souces, it is important to collect this information for analysis. 

You can collect a Windows binary signature using Powershell.
```
Get-AuthenticodeSignature -FilePath "suspicious_file.extension"
```

You can collect a website SSL signature using openssl.
```
echo -n | openssl s_client -connect {HOSTNAME}:{PORT} -showcerts
```
*Note: `echo -n` gives a response to the server so that the connection is released and `-showcerts` downloads all the certificates in the chain.*
