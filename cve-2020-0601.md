# CVE 2020-0601 AKA "Curveball"
A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates.An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source, aka 'Windows CryptoAPI Spoofing Vulnerability'.

## Reference
https://nvd.nist.gov/vuln/detail/CVE-2020-0601

## MITRE ATT&CK
```
Name: Code Signing
ID: T1116
Tactic: Defense Evasion
Platform: macOS, Windows
Data Sources: Binary file metadata
Defense Bypassed: Windows User Account Control
```
https://attack.mitre.org/techniques/T1116/

## KQL
Data Source: [Winlogbeat](https://www.elastic.co/beats/winlogbeat)  
Query: `winlog.provider_name:"Microsoft-Windows-Audit-CVE"`

Data Source: [Zeek CVE-2020-0601 Plugin](https://github.com/0xxon/cve-2020-0601-plugin)  
Query: `zeek.notice.note:"CVE_2020-0601::Unknown_X509_Curve"`

## Analysis Notes
"Curveball" is an exploit that attempts to make a malicious executable or website certificate appear like it was signed by a trusted and legitiate source. In the event this is observed, analysts should begin looking back through the Application log to identify recently executed binaries or network logs to identify recently viewed websites on the affected host(s) and validate their signatures and behavior. 

### Collection 
While the signatures can be made to look like they're from valid souces, it is important to collect this information for analysis. 

You can collect a Windows binary signature using Powershell.
```
Get-AuthenticodeSignature -FilePath "suspicious_file.extension"
```

You can collect a website SSL signature using openssl.
```
echo -n | openssl s_client -connect {HOSTNAME}:{PORT} -showcerts
```
*Note: `echo -n` gives a response to the server so that the connection is released and `-showcerts` downloads all the certificates in the chain.*
